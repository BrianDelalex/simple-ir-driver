/*****************************************************************************\
**  This file is part of simple-ir-driver project, and is made available under
**  ther terms of the GNU AFFERO General Public License version 3.
**
**  Copyright (C) 2025 - Brian DELALEX-FONDU
**
\*****************************************************************************/

#include <linux/cdev.h>
#include <linux/slab.h>

#include "irdriver.h"
#include "irsignal.h"

const int VOL_MINUS_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    860, 426,
    60, 48,
    60, 48,
    58, 50,
    60, 48,
    58, 48,
    60, 48,
    60, 48,
    62, 46,
    60, 154,
    58, 154,
    64, 150,
    60, 154,
    60, 152,
    60, 154,
    60, 48,
    62, 152,
    60, 48,
    58, 50,
    62, 44,
    60, 48,
    60, 48,
    60, 48,
    62, 46,
    58, 50,
    60, 152,
    60, 154,
    60, 154,
    58, 156,
    62, 150,
    60, 154,
    60, 154,
    58, 154,
    60, 3914,
    864, 210,
    58, 9176,
    868, 204,
    60, 0
};

const int PLAY_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    774, 426,
    58, 50,
    60, 48,
    58, 48,
    60, 48,
    60, 48,
    60, 48,
    60, 48,
    60, 48,
    60, 154,
    60, 154,
    58, 156,
    58, 154,
    60, 154,
    60, 154,
    60, 48,
    60, 154,
    58, 154,
    60, 48,
    60, 48,
    60, 48,
    60, 48,
    60, 48,
    60, 48,
    60, 48,
    60, 48,
    60, 154,
    58, 156,
    58, 154,
    60, 154,
    60, 154,
    60, 154,
    60, 152,
    60, 3914,
    866, 208,
    60, 0
};

const int VOL_PLUS_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    770, 430,
    56, 52,
    56, 52,
    56, 50,
    58, 50,
    58, 50,
    58, 50,
    58, 50,
    56, 52,
    58, 156,
    56, 158,
    56, 156,
    58, 156,
    56, 158,
    58, 156,
    56, 52,
    60, 154,
    56, 50,
    58, 156,
    58, 50,
    60, 48,
    60, 48,
    60, 48,
    60, 48,
    56, 52,
    60, 154,
    56, 52,
    58, 154,
    60, 154,
    60, 154,
    60, 154,
    58, 154,
    62, 152,
    60, 3914,
    64, 212,
    56, 0
};

const int SETUP_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    934, 462,
    62, 56,
    62, 54,
    60, 56,
    62, 54,
    62, 54,
    62, 56,
    62, 54,
    60, 56,
    62, 168,
    62, 170,
    60, 170,
    62, 168,
    62, 168,
    62, 170,
    60, 56,
    60, 170,
    62, 54,
    62, 54,
    62, 170,
    62, 54,
    62, 54,
    62, 56,
    60, 56,
    62, 54,
    62, 168,
    62, 168,
    62, 56,
    60, 170,
    60, 170,
    62, 170,
    60, 170,
    62, 168,
    62, 4226,
    934, 228,
    62, 3352,
    932, 230,
    60, 0
};

const int PREVIOUS_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    932, 462,
    62, 54,
    62, 54,
    62, 56,
    60, 56,
    62, 54,
    60, 56,
    62, 54,
    62, 54,
    62, 168,
    62, 170,
    60, 170,
    62, 168,
    62, 168,
    62, 168,
    64, 54,
    62, 168,
    62, 168,
    62, 54,
    62, 170,
    60, 56,
    60, 56,
    62, 54,
    62, 54,
    62, 54,
    62, 56,
    60, 170,
    62, 54,
    62, 168,
    62, 168,
    64, 168,
    60, 170,
    62, 168,
    62, 4228,
    932, 228,
    62, 0
};

const int STOP_MODE_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    930, 462,
    62, 54,
    62, 56,
    62, 54,
    60, 56,
    62, 54,
    62, 56,
    60, 56,
    62, 54,
    62, 168,
    62, 168,
    62, 168,
    62, 170,
    60, 170,
    60, 170,
    62, 54,
    62, 168,
    62, 54,
    62, 170,
    60, 170,
    62, 54,
    62, 54,
    62, 54,
    62, 56,
    60, 56,
    62, 168,
    62, 54,
    62, 54,
    62, 170,
    60, 170,
    62, 168,
    62, 168,
    62, 168,
    62, 4226,
    932, 230,
    62, 0
};

const int CHNL_MINUS_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    934, 460,
    64, 52,
    66, 50,
    66, 52,
    64, 52,
    64, 52,
    62, 54,
    62, 56,
    60, 56,
    60, 170,
    62, 168,
    62, 168,
    62, 170,
    60, 170,
    60, 170,
    62, 54,
    62, 168,
    62, 56,
    60, 56,
    62, 54,
    60, 170,
    62, 54,
    62, 54,
    62, 56,
    62, 54,
    62, 168,
    62, 168,
    62, 170,
    60, 56,
    60, 170,
    62, 168,
    62, 168,
    68, 164,
    60, 4228,
    932, 228,
    62, 0
};

const int ENTER_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    930, 462,
    62, 58,
    58, 58,
    60, 56,
    58, 60,
    58, 56,
    60, 58,
    58, 58,
    58, 58,
    60, 168,
    60, 170,
    62, 168,
    62, 168,
    62, 168,
    62, 170,
    62, 54,
    60, 170,
    62, 168,
    62, 54,
    62, 56,
    62, 168,
    62, 54,
    62, 54,
    62, 54,
    62, 56,
    62, 54,
    60, 170,
    62, 168,
    62, 54,
    62, 170,
    60, 170,
    60, 170,
    62, 168,
    62, 4230,
    930, 230,
    60, 0
};

const int CHNL_PLUS_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    930, 462,
    60, 56,
    62, 54,
    62, 54,
    62, 54,
    62, 54,
    62, 56,
    60, 56,
    62, 54,
    60, 170,
    62, 168,
    62, 168,
    62, 168,
    62, 170,
    60, 170,
    62, 54,
    62, 168,
    64, 52,
    64, 166,
    66, 52,
    64, 166,
    64, 52,
    64, 52,
    64, 52,
    64, 52,
    64, 166,
    64, 54,
    64, 166,
    64, 52,
    64, 166,
    66, 164,
    64, 166,
    66, 166,
    62, 4226,
    934, 226,
    64, 0
};

const int CHNL_ZERO_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    932, 462,
    60, 56,
    62, 54,
    62, 54,
    62, 54,
    62, 54,
    62, 56,
    60, 56,
    60, 56,
    60, 170,
    62, 168,
    62, 168,
    62, 170,
    60, 170,
    60, 170,
    62, 54,
    62, 168,
    62, 54,
    62, 56,
    60, 170,
    60, 170,
    60, 56,
    62, 54,
    62, 56,
    60, 54,
    64, 168,
    62, 168,
    62, 54,
    62, 54,
    62, 168,
    62, 168,
    62, 170,
    60, 170,
    60, 4228,
    932, 228,
    62, 3352,
    930, 228,
    62, 0
};

const int NEXT_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    932, 462,
    60, 56,
    62, 54,
    62, 54,
    62, 54,
    62, 54,
    64, 54,
    60, 56,
    62, 54,
    60, 170,
    62, 168,
    62, 168,
    62, 170,
    62, 168,
    60, 170,
    62, 54,
    62, 168,
    62, 168,
    62, 56,
    60, 170,
    62, 168,
    62, 54,
    62, 56,
    60, 54,
    62, 56,
    62, 54,
    62, 168,
    62, 58,
    58, 56,
    60, 170,
    62, 168,
    60, 170,
    62, 168,
    62, 4226,
    932, 228,
    62, 0
};

const int BACK_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    930, 462,
    62, 56,
    60, 56,
    60, 56,
    64, 52,
    62, 54,
    62, 54,
    62, 54,
    62, 54,
    62, 170,
    60, 170,
    60, 170,
    62, 168,
    62, 168,
    62, 168,
    62, 54,
    62, 170,
    60, 56,
    60, 170,
    62, 168,
    62, 168,
    62, 54,
    62, 54,
    62, 56,
    64, 52,
    60, 170,
    60, 56,
    62, 54,
    62, 54,
    62, 168,
    62, 168,
    62, 170,
    60, 170,
    62, 4226,
    930, 230,
    60, 0
};

const int CHNL_ONE_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    938, 460,
    62, 54,
    64, 52,
    64, 54,
    62, 54,
    64, 52,
    64, 52,
    66, 50,
    66, 52,
    64, 166,
    64, 166,
    64, 168,
    64, 166,
    64, 166,
    64, 166,
    64, 54,
    64, 166,
    64, 52,
    64, 52,
    64, 52,
    66, 52,
    64, 166,
    64, 52,
    64, 54,
    64, 52,
    64, 166,
    64, 166,
    66, 164,
    66, 166,
    64, 52,
    64, 166,
    64, 168,
    64, 166,
    64, 4224,
    936, 226,
    64, 0
};

const int CHNL_TWO_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    934, 460,
    64, 52,
    64, 52,
    66, 52,
    64, 52,
    64, 52,
    64, 52,
    64, 52,
    66, 52,
    64, 166,
    64, 166,
    64, 166,
    64, 166,
    66, 166,
    64, 166,
    62, 54,
    64, 166,
    64, 166,
    64, 52,
    66, 52,
    64, 52,
    64, 166,
    64, 52,
    64, 54,
    64, 52,
    64, 52,
    64, 166,
    66, 164,
    64, 168,
    64, 52,
    64, 166,
    64, 166,
    68, 162,
    66, 4214,
    936, 226,
    64, 0
};

const int CHNL_THREE_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    930, 462,
    64, 52,
    64, 52,
    62, 56,
    64, 52,
    60, 56,
    62, 54,
    64, 52,
    62, 56,
    64, 164,
    64, 168,
    62, 168,
    62, 168,
    62, 168,
    62, 170,
    60, 56,
    62, 168,
    60, 56,
    62, 168,
    62, 56,
    60, 56,
    62, 168,
    62, 54,
    62, 54,
    66, 52,
    62, 168,
    62, 54,
    62, 170,
    60, 170,
    64, 52,
    62, 168,
    62, 168,
    62, 170,
    60, 4228,
    932, 230,
    60, 0
};

const int CHNL_FOUR_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    934, 462,
    62, 54,
    62, 54,
    62, 54,
    62, 56,
    60, 56,
    60, 56,
    60, 56,
    62, 54,
    62, 168,
    62, 170,
    62, 168,
    60, 170,
    62, 168,
    66, 166,
    60, 56,
    60, 170,
    62, 56,
    60, 56,
    62, 168,
    62, 54,
    62, 170,
    60, 56,
    60, 56,
    62, 54,
    62, 170,
    60, 170,
    62, 54,
    62, 168,
    62, 56,
    60, 170,
    60, 170,
    62, 168,
    62, 4226,
    932, 228,
    62, 0
};

const int CHNL_FIVE_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    942, 456,
    64, 52,
    64, 52,
    62, 54,
    64, 52,
    66, 50,
    66, 52,
    64, 52,
    62, 54,
    62, 168,
    60, 170,
    62, 168,
    62, 168,
    62, 168,
    62, 170,
    60, 56,
    60, 170,
    60, 170,
    62, 54,
    62, 168,
    62, 54,
    62, 170,
    60, 56,
    60, 56,
    60, 56,
    64, 52,
    62, 168,
    62, 54,
    62, 168,
    62, 56,
    60, 170,
    60, 170,
    60, 170,
    62, 4224,
    934, 230,
    60, 0
};

const int CHNL_SIX_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    932, 460,
    64, 52,
    64, 52,
    64, 54,
    64, 50,
    66, 52,
    64, 52,
    64, 52,
    64, 52,
    64, 166,
    64, 168,
    64, 164,
    66, 166,
    64, 166,
    64, 166,
    64, 52,
    64, 166,
    64, 52,
    66, 166,
    66, 164,
    64, 52,
    64, 166,
    64, 52,
    64, 52,
    66, 52,
    64, 166,
    64, 52,
    64, 52,
    64, 166,
    62, 54,
    64, 166,
    66, 164,
    66, 166,
    64, 4224,
    934, 226,
    64, 0
};

const int CHNL_SEVEN_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    932, 460,
    64, 52,
    64, 52,
    64, 52,
    64, 52,
    64, 52,
    66, 52,
    64, 52,
    64, 52,
    64, 166,
    64, 166,
    62, 168,
    64, 166,
    66, 166,
    62, 168,
    60, 56,
    64, 166,
    64, 52,
    62, 54,
    62, 54,
    62, 168,
    64, 168,
    64, 52,
    64, 52,
    62, 54,
    62, 168,
    62, 168,
    62, 170,
    62, 54,
    60, 56,
    62, 168,
    62, 168,
    62, 168,
    62, 4226,
    934, 224,
    64, 0
};

const int CHNL_EIGHT_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    932, 460,
    64, 52,
    64, 52,
    64, 54,
    64, 52,
    64, 52,
    64, 52,
    64, 52,
    64, 52,
    66, 164,
    64, 166,
    64, 168,
    64, 164,
    66, 166,
    64, 166,
    62, 54,
    62, 168,
    62, 168,
    62, 54,
    62, 54,
    62, 168,
    64, 168,
    60, 56,
    60, 56,
    62, 54,
    62, 54,
    62, 168,
    62, 168,
    62, 54,
    62, 56,
    66, 164,
    62, 168,
    60, 170,
    62, 4226,
    932, 226,
    62, 3348,
    930, 230,
    62, 0
};

const int CHNL_NINE_SIGNAL[] = {
// ON, OFF (in 10's of microseconds)
    926, 464,
    60, 56,
    60, 62,
    54, 58,
    62, 54,
    58, 60,
    56, 64,
    52, 60,
    62, 52,
    60, 170,
    60, 170,
    58, 172,
    60, 170,
    60, 172,
    58, 170,
    60, 54,
    62, 174,
    56, 60,
    58, 168,
    60, 58,
    60, 174,
    54, 176,
    54, 62,
    56, 60,
    56, 60,
    56, 174,
    56, 58,
    58, 178,
    52, 58,
    58, 60,
    56, 176,
    56, 174,
    54, 176,
    56, 4228,
    928, 234,
    56, 0
};

# define ADD_SIGNAL_PULSES(arr, pulse_arr, cd)                \
    arr->pulses = pulse_arr;                                    \
    arr->pulses_count = sizeof(pulse_arr) / (sizeof(int));    \
    arr->code = cd;                                           \
    arr->valid = true;                                          \

struct signal_pulses_s* get_signal_pulses_array(int* size)
{
    static const int array_size = 21;
    struct signal_pulses_s* sig_pulses_arr;
    
    sig_pulses_arr = kmalloc(sizeof(struct signal_pulses_s) * array_size,
                             GFP_KERNEL);

    if (sig_pulses_arr == NULL) {
        PERR("Out of memory! in get_signal_pulses_array.");
        return NULL;
    }

    ADD_SIGNAL_PULSES((&(sig_pulses_arr[0])), VOL_MINUS_SIGNAL, VOL_MINUS);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[1])), PLAY_SIGNAL, PLAY);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[2])), VOL_PLUS_SIGNAL, VOL_PLUS);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[3])), SETUP_SIGNAL, SETUP);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[4])), PREVIOUS_SIGNAL, PREVIOUS);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[5])), STOP_MODE_SIGNAL, STOP_MODE);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[6])), CHNL_MINUS_SIGNAL, CHNL_MINUS);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[7])), ENTER_SIGNAL, ENTER);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[8])), CHNL_PLUS_SIGNAL, CHNL_PLUS);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[9])), CHNL_ZERO_SIGNAL, CHNL_ZERO);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[10])), NEXT_SIGNAL, NEXT);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[11])), BACK_SIGNAL, BACK);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[12])), CHNL_ONE_SIGNAL, CHNL_ONE);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[13])), CHNL_TWO_SIGNAL, CHNL_TWO);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[14])), CHNL_THREE_SIGNAL, CHNL_THREE);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[15])), CHNL_FOUR_SIGNAL, CHNL_FOUR);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[16])), CHNL_FIVE_SIGNAL, CHNL_FIVE);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[17])), CHNL_SIX_SIGNAL, CHNL_SIX);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[18])), CHNL_SEVEN_SIGNAL, CHNL_SEVEN);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[19])), CHNL_EIGHT_SIGNAL, CHNL_EIGHT);
    ADD_SIGNAL_PULSES((&(sig_pulses_arr[20])), CHNL_NINE_SIGNAL, CHNL_NINE);


    *size = array_size;
    return sig_pulses_arr;
}